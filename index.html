<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/png" href="/logo192.png" />

  <!-- Viewport optimizado: Agregado viewport-fit=cover -->
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />

  <!-- Meta tags para PWA (Corrige la advertencia de consola) -->
  <meta name="theme-color" content="#2563eb" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="application-name" content="MiNegocio" />

  <title>MiNegocio POS</title>

  <!-- Enlace al manifiesto -->
  <link rel="manifest" href="/manifest.json" />
</head>

<body>
  <div id="root"></div>
  <!-- Carga del script principal -->
  <script>
    window.onerror = function (message, source, lineno, colno, error) {
      // Si el error es de carga de archivos (Script error) o React no arranca en 3 segundos
      if (message.includes('Script error') || message.includes('dynamically imported module')) {
        // Mostramos un aviso nativo del navegador
        const root = document.getElementById('root');
        root.innerHTML = `
          <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;font-family:sans-serif;text-align:center;padding:20px;">
            <h2 style="color:#333;">Actualización Detectada</h2>
            <p style="color:#666;">Hay una nueva versión de la app.</p>
            <button onclick="window.location.reload(true)" style="background:#2563eb;color:white;border:none;padding:15px 30px;border-radius:10px;font-size:16px;font-weight:bold;margin-top:20px;cursor:pointer;">
              Actualizar Ahora
            </button>
          </div>
        `;
        // Forzamos al Service Worker a actualizarse si es posible
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.getRegistrations().then(function (registrations) {
            for (let registration of registrations) { registration.unregister(); }
          });
        }
      }
    };
  </script>
  <script type="module" src="/src/main.jsx"></script>
</body>

</html>